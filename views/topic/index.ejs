<section id="posts">
		
	<header class="clearfix">
		<div class="pull-left">
			<h5><%= topic.name %></h5>
		</div>
		<div class="pull-right text-right">
			<span data-toggle="tooltip" title="Views" class="marginRight10">
				<em class="fa fa-eye"></em > <%= topic.views %>
			</span>
			<span data-toggle="tooltip" title="Replies">
				<em class="fa fa-pencil"></em > <%= topic.replies %>
			</span>
		</div>
	</header>

	<div id="post-list">
		<% _.each(posts, function (post) { %>
			<% include ../partials/post/single.ejs %>
		<% }) %>
	</div>
</section>

<div class="post-buttons clearfix">
	
	<div class="pull-left">	
		<% if (topic.locked) { %>
			<button class="btn btn-danger">
				Locked
			</button>	
		<% } else { %>
			<button id="add-post" class="btn btn-orange" data-event="click" data-action="post.newTrigger">
				Add Reply
			</button>
			<button id="save-post" class="btn btn-orange hide" data-event="click" data-action="post.create">
				Save Post
			</button>
		<% } %>
	</div>
</div>

<script>
	$(function () {

		$(document).on('scroll', function () {
			
			if ($(window).scrollTop() == $(this).height() - $(window).height()) {
				ASF.topic.loadMorePosts(<%= topic.id %>, $('.post').length);
			}

		});

	});

	ASF.globals.forum = <%-: topic.forum|json_encode %>;
	ASF.globals.topic = <%-: topic|json_encode %>;

	ASF.page.sidebar = <%-: sails.config.sidebars[section]|json_encode %>;
</script>